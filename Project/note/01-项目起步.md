# é¡¹ç›®èµ·æ­¥



## é¡¹ç›®é¢„è§ˆåœ°å€

å°å…”é²œå„¿å•†åŸï¼šhttp://erabbit.itheima.net/#/

## åˆ›å»ºé¡¹ç›®

**ç›®æ ‡**ï¼šä½¿ç”¨ `vite` åˆå§‹åŒ–å°å…”é²œé¡¹ç›®

**æ ¸å¿ƒæ­¥éª¤ï¼š**

- åˆå§‹åŒ–é¡¹ç›®

```bash
yarn create vue
æˆ–
npm init vue
```

- ä¸€é¡¿æ“ä½œ

```shell
âˆš Project name: ... vue3-ts-pinia-router-eslint
âˆš Add TypeScript? ... Yes âœ…
âˆš Add JSX Support? ... Yes âœ…
âˆš Add Vue Router for Single Page Application development? ... Yes âœ…
âˆš Add Pinia for state management? ... Yes âœ…
âˆš Add Vitest for Unit Testing? ... No âŒ
âˆš Add Cypress for both Unit and End-to-End testing? ... No âŒ
âˆš Add ESLint for code quality? ... Yes âœ…
âˆš Add Prettier for code formatting? ... Yes âœ…
```

- è¿›å…¥åˆ° `rabbit-vue3-ts` é¡¹ç›®ä¸­ï¼Œå®‰è£…ä¾èµ–åŒ…

```
yarn
```

- `eslint` æ ¼å¼åŒ–é¡¹ç›®æ–‡ä»¶

```
yarn lint
```

- å¯åŠ¨é¡¹ç›®

```
yarn dev
```



### åˆ›å»º `Vue3` é¡¹ç›®å‘½ä»¤å¯¹æ¯”

**`Vue3` åŸºç¡€é˜¶æ®µå‘½ä»¤**

- èƒ½ä½¿ç”¨ï¼Œä½†æ˜¯é…ç½®å¤ªç®€å•äº†ï¼Œå­¦ä¹  `Vue3` åŸºç¡€å¯ä»¥ï¼Œé¡¹ç›®è¿˜éœ€è¦é¢å¤–é…ç½®å¾ˆå¤šä¸œè¥¿ï¼Œæ•ˆç‡ä½ã€‚

```sh
yarn create vite
# æˆ–
npm init vite
```

**`Vue3` é¡¹ç›®é˜¶æ®µå‘½ä»¤**

- `Vue3` å®˜æ–¹æ¨èæ–¹å¼ï¼Œå¯ä»¥æ ¹æ®é¡¹ç›®æƒ…å†µæŒ‰éœ€é€‰æ‹©é…ç½®ï¼Œæ¨èä½¿ç”¨ã€‚

```sh
yarn create vue
# æˆ–
npm init vue
```



### å¸¸è§é—®é¢˜

- Node ç‰ˆæœ¬é—®é¢˜

`yarn create vue`  çš„ä¾èµ–åŒ…è¦æ±‚ `Node 15+` ä»¥ä¸Šï¼Œå»ºè®®å¤§å®¶ç›´æ¥å‡çº§åˆ° `Node 16` ç‰ˆæœ¬ã€‚

![image-20220218091016277](media/image-20220218091016277.png)

- VsCode æ’ä»¶
  - å®‰è£…æ’ä»¶  `vue.volar`   å’Œ  `vue.vscode-typescript-vue-plugin`
  - ç¦ç”¨æ’ä»¶  ` octref.vetur `   å’Œ `@builtin typescript`ï¼Œç¦ç”¨åè®°å¾—é‡å¯ã€‚

## Git ç‰ˆæœ¬ç®¡ç†

### åˆå§‹åŒ–å’Œå¼€å‘åˆ†æ”¯å‡†å¤‡

```shell
# åˆå§‹åŒ–é¡¹ç›®ä»“åº“
git init

# å°†æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº
git add .

# æäº¤åˆ°ä»“åº“
git commit -m 'åˆå§‹åŒ–æäº¤'

# ğŸš¨ æ–°å»º dev åˆ†æ”¯å¹¶åˆ‡æ¢ - ç”¨äºå¼€å‘
git checkout -b dev
```

### ä½¿ç”¨ `gitee` ç®¡ç†é¡¹ç›®

**ç›®æ ‡ï¼š**èƒ½å¤Ÿä½¿ç”¨ git ç®¡ç†é¡¹ç›®ï¼Œå¹¶ä¸”èƒ½å¤Ÿå°†ä»£ç ä¸Šä¼ åˆ°ç äº‘

**æ ¸å¿ƒæ­¥éª¤ï¼š**

- åœ¨[ç äº‘](https://gitee.com/)ä¸Šåˆ›å»ºé¡¹ç›®`rabbit-vue3-ts`

![image-20211229155056153](media/image-20211229155056153.png)

- è®¾ç½®ä»“åº“åˆ«å

```bash
git remote add origin xxxxxxx
```

- æ¨é€åˆ°è¿œç¨‹ä»“åº“

```bash
# æ¨é€ä¸»åˆ†æ”¯
git push -u origin "master"

# æ¨é€å¼€å‘åˆ†æ”¯
git push -u origin "dev"
```

## ç›®å½•è°ƒæ•´

**ç›®æ ‡ï¼š**èƒ½å¤Ÿè°ƒæ•´é¡¹ç›®çš„ç›®å½•ç»“æ„ï¼Œè§„èŒƒå¼€å‘ç¯å¢ƒã€‚

### ç›®å½•è°ƒæ•´

**åˆ é™¤æ–‡ä»¶**

-  `src` ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶

**æ–°å»ºæ–‡ä»¶**

- `src/App.vue ` æ ¹ç»„ä»¶

```vue
<template>
  <h1>Vue3+TS+VueRouter4+Pinia-æ–°ç‰ˆå°å…”é²œå„¿</h1>
</template>
```

- `src/main.ts` 

```ts
// Vue é¡¹ç›®å…¥å£æ–‡ä»¶
import { createApp } from "vue";
import App from "./App.vue";

const app = createApp(App);
app.mount("#app");
```

**é¡¹ç›®æ–‡ä»¶å¤¹è§„èŒƒ**

- `utils` ç”¨äºå­˜æ”¾å·¥å…·ç›¸å…³
- `assets/images` ç”¨äºå­˜æ”¾å›¾ç‰‡ç›¸å…³
- `assets/styles` ç”¨äºå­˜æ”¾æ ·å¼ç›¸å…³
- `router` ç”¨äºå­˜æ”¾è·¯ç”±ç›¸å…³
- `store`ç”¨äºå­˜æ”¾æ•°æ®ç›¸å…³
- `views`ç”¨äºå­˜æ”¾é¡µé¢çº§åˆ«çš„ç»„ä»¶
- `components`ç”¨äºå­˜æ”¾å…¬å…±çš„ç»„ä»¶
- `types`ç”¨äºå­˜æ”¾ ts çš„å…¬å…±ç±»å‹



## `axios` è¯·æ±‚åº“

**ç›®çš„ï¼š**åŸºäº `axios` å°è£…ä¸€ä¸ªè¯·æ±‚å·¥å…·ï¼Œè°ƒç”¨æ¥å£æ—¶ä½¿ç”¨ã€‚

- å®‰è£… `axios`

```bash
yarn add axios
```

- æ–°å»º `src/utils/request.ts` æ¨¡å—ï¼Œä»£ç å¦‚ä¸‹

```js
import axios from 'axios'

// åˆ›å»º axios å®ä¾‹
const instance = axios.create({
  baseURL: 'http://pcapi-xiaotuxian-front-devtest.itheima.net/',
  timeout: 50000
})

// æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨
instance.interceptors.request.use(
  function (config) {
    // åœ¨å‘é€è¯·æ±‚ä¹‹å‰åšäº›ä»€ä¹ˆ
    return config
  },
  function (error) {
    // å¯¹è¯·æ±‚é”™è¯¯åšäº›ä»€ä¹ˆ
    return Promise.reject(error)
  }
)

// æ·»åŠ å“åº”æ‹¦æˆªå™¨
instance.interceptors.response.use(
  function (response) {
    return response
  },
  function (error) {
    // å¯¹å“åº”é”™è¯¯åšç‚¹ä»€ä¹ˆ
    return Promise.reject(error)
  }
)

export default instance
```

- åœ¨`App.vue`æ–‡ä»¶ä¸­è¿›è¡Œæµ‹è¯•

```vue
<script setup lang="ts">
import request from "./utils/request";
import { onMounted } from "vue";

onMounted(async () => {
  const res = await request.get("/home/index");
  console.log(res);
});
</script>

<template>
  <h1>Vue3+TSå°å…”é²œå„¿</h1>
</template>
```



## æ ·å¼å¤„ç†-less å˜é‡ä¸ mixins

**ç›®æ ‡ï¼š** èƒ½å¤Ÿä½¿ç”¨ less å˜é‡å®šä¹‰é¡¹ç›®ä¸­å¸¸ç”¨çš„é¢œè‰²ï¼Œä½¿ç”¨ mixins å®šä¹‰é¡¹ç›®ä¸­å¸¸ç”¨çš„æ ·å¼

**æ ¸å¿ƒæ­¥éª¤**

- å®‰è£… `less`

```shell
yarn add less
```

- æ–°å»ºå˜é‡ `src/assets/styles/variables.less`

```less
// ä¸»é¢˜
@xtxColor: #27ba9b;
// è¾…åŠ©
@helpColor: #e26237;
// æˆåŠŸ
@sucColor: #1dc779;
// è­¦å‘Š
@warnColor: #ffb302;
// ä»·æ ¼
@priceColor: #cf4444;
```

- æ··å…¥ `src/assets/styles/mixins.less`

```less
// é¼ æ ‡ç»è¿‡ä¸Šç§»é˜´å½±åŠ¨ç”»
.hoverShadow () {
  transition: all 0.5s;
  &:hover {
    transform: translate3d(0, -3px, 0);
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
  }
}
```

- åœ¨ `App.vue` ä¸­æµ‹è¯•

```vue
<style lang="less">
// å¿…é¡»å¯¼å…¥ variables.less
@import "@/assets/styles/variables.less";
@import "@/assets/styles/mixins.less";

h1 {
  color: @warnColor;
  .hoverShadow();
}
</style>
```

## Vite é…ç½® - è‡ªåŠ¨å¯¼å…¥æ ·å¼

ğŸš¨é—®é¢˜ï¼š`variables.less`å’Œ`mixins.less` ä¸¤ä¸ª less æ–‡ä»¶æ˜¯éœ€è¦åœ¨å¤šä¸ªç»„ä»¶ä¸­å»ä½¿ç”¨çš„ã€‚ä½†æ˜¯å¦‚æœç»„ä»¶ä¸­ä¸å¯¼å…¥ï¼Œç›´æ¥ä½¿ç”¨ä¼šæŠ¥é”™ã€‚

**ç›®æ ‡ï¼š** é€šè¿‡ `vite` é…ç½®è‡ªåŠ¨å¯¼å…¥é¡¹ç›®ä¸­çš„`lesså˜é‡`å’Œ`mixins`

**å‚è€ƒæ–‡æ¡£ï¼š**https://cn.vitejs.dev/config/shared-options.html#css-preprocessoroptions

**æ ¸å¿ƒæ­¥éª¤ï¼š**

- ä¿®æ”¹`vite.config.ts` æ–‡ä»¶ï¼Œå¢åŠ å†…å®¹

```diff
export default defineConfig({
// ...çœç•¥
+  css: {
+    // https://cn.vitejs.dev/config/shared-options.html#css-preprocessoroptions
+    preprocessorOptions: {
+      less: {
+        additionalData: `
+          @import "@/assets/styles/variables.less";
+          @import "@/assets/styles/mixins.less";
+        `,
+      },
+    },
+  },
})
```

- ä¿®æ”¹ App.vue ä¸­çš„ä»£ç 

```diff
<style lang="less" scoped>
- @import "@/assets/styles/variables.less";
- @import "@/assets/styles/mixins.less";
h1 {
  background-color: @warnColor;
  .hoverShadow();
}
</style>
```

- `yarn dev` é‡å¯è„šæ‰‹æ¶ï¼Œæµè§ˆå™¨åˆ·æ–°æŸ¥çœ‹æ•ˆæœã€‚

## æ ·å¼å¤„ç†-æ ‡ç­¾æ ·å¼é‡ç½®

**ç›®æ ‡ï¼š**èƒ½å¤Ÿä½¿ç”¨åŠŸèƒ½ [`normalize.css`](https://github.com/necolas/normalize.css)é‡ç½®é¡¹ç›®ä¸­çš„æ ·å¼

**ç®€ä»‹**

- `normalize.css` ä½¿æµè§ˆå™¨å‘ˆç°æ‰€æœ‰æ ‡ç­¾æ ·å¼æ›´åŠ ä¸€è‡´ï¼Œç¬¦åˆç°ä»£æ ‡å‡†ã€‚

**æ ¸å¿ƒæ­¥éª¤**

- å®‰è£… `normalize.css`

```js
yarn add normalize.css
```

- ä½¿ç”¨ `normalize.css`

`main.ts` å¯¼å…¥ `normalize.css` å³å¯ã€‚

```diff
import { createApp } from 'vue'
import App from './App.vue'

+ import 'normalize.css'

createApp(App).mount('#app')
```

- åœ¨ `App.vue` ä¸­æµ‹è¯•

```jsx
<template>
  <div>
    <p>å“ˆå“ˆå“ˆ</p>
    <ul>
      <li>123</li>
      <li>456</li>
    </ul>
    <h1>è¿™æ˜¯å¤§æ ‡é¢˜</h1>
  </div>
</template>
```

**é€šè¿‡æ•ˆæœä¼šå‘ç°ï¼Œh1 ul ç­‰æ ·å¼è¿˜æ˜¯ä¿ç•™çš„ï¼Œä½†æ˜¯ä¸ä¸€è‡´çš„æ ·å¼å·²ç»è¢«é‡ç½®äº†ï¼Œç¡®ä¿ä¸åŒçš„æµè§ˆå™¨ç»Ÿä¸€æ ‡ç­¾æ ·å¼**

## æ ·å¼å¤„ç†-å…¬å…±æ ·å¼

**ç›®æ ‡ï¼š**èƒ½å¤Ÿç»™é¡¹ç›®è®¾ç½®é€šç”¨çš„æ ·å¼ã€‚è™½ç„¶æœ‰äº†é‡ç½®æ ·å¼ï¼Œä½†æ˜¯é¡¹ç›®ä¸­ä¾æ—§éœ€è¦é¡¹ç›®çš„é€šç”¨æ ·å¼ã€‚

**æ ¸å¿ƒæ­¥éª¤**

- æ–°å»ºæ–‡ä»¶ `src/assets/styles/common.less`

```less
// æŒ‰ç…§ç½‘ç«™è‡ªå·±çš„éœ€æ±‚ï¼Œæä¾›å…¬ç”¨çš„æ ·å¼
* {
  box-sizing: border-box;
}

html {
  height: 100%;
  font-size: 14px;
}

body {
  height: 100%;
  color: #333;
  min-width: 1240px;
  font: 1em/1.4 'Microsoft Yahei', 'PingFang SC', 'Avenir', 'Segoe UI', 'Hiragino Sans GB', 'STHeiti', 'Microsoft Sans Serif', 'WenQuanYi Micro Hei', sans-serif;
}

ul,
h1,
h3,
h4,
p,
dl,
dd {
  padding: 0;
  margin: 0;
}

a {
  text-decoration: none;
  color: #333;
  outline: none;
}

i {
  font-style: normal;
}

input[type='text'],
input[type='search'],
input[type='password'],
input[type='checkbox'] {
  padding: 0;
  outline: none;
  border: none;
  -webkit-appearance: none;
  &::placeholder {
    color: #ccc;
  }
}

img {
  max-width: 100%;
  max-height: 100%;
  vertical-align: middle;
  //  background: #ebebeb;
}

ul {
  list-style: none;
}

#app {
  background-color: #f5f5f5;
}

.container {
  width: 1240px;
  margin: 0 auto;
  position: relative;
}

// ä¸€è¡Œçœç•¥
.ellipsis {
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
// äºŒè¡Œçœç•¥
.ellipsis-2 {
  word-break: break-all;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
  overflow: hidden;
}

.fl {
  float: left;
}

.fr {
  float: right;
}

.clearfix:after {
  content: '.';
  display: block;
  visibility: hidden;
  height: 0;
  line-height: 0;
  clear: both;
}

// é—ªåŠ¨ç”»
.shan {
  &::after {
    content: '';
    position: absolute;
    animation: shan 1.5s ease 0s infinite;
    top: 0;
    width: 30%;
    height: 100%;
    background: linear-gradient(to left, rgba(255, 255, 255, 0) 0, rgba(255, 255, 255, 0.3) 50%, rgba(255, 255, 255, 0) 100%);
    transform: skewX(-45deg);
  }
}
@keyframes shan {
  0% {
    left: -100%;
  }
  100% {
    left: 120%;
  }
}

// ç¦»å¼€æ·¡å‡ºåŠ¨ç”»
.fade {
  &-leave {
    &-active {
      position: absolute;
      width: 100%;
      transition: opacity 0.5s 0.2s;
      z-index: 1;
    }
    &-to {
      opacity: 0;
    }
  }
}

// 1. ç¦»å¼€ï¼Œé€æ˜åº¦  1---->0    ä½ç§» 0---->30
// 2. è¿›å…¥ï¼Œé€æ˜åº¦  0---->1    ä½ç§» 30---->0
// æ‰§è¡Œé¡ºåºï¼Œå…ˆç¦»å¼€å†è¿›å…¥
.pop {
  &-leave {
    &-from {
      opacity: 1;
      transform: none;
    }
    &-active {
      transition: all 0.5s;
    }
    &-to {
      opacity: 0;
      transform: translateX(20px);
    }
  }
  &-enter {
    &-from {
      opacity: 0;
      transform: translateX(20px);
    }
    &-active {
      transition: all 0.5s;
    }
    &-to {
      opacity: 1;
      transform: none;
    }
  }
}

// è¡¨å•
.xtx-form {
  padding: 50px 0;
  &-item {
    display: flex;
    align-items: center;
    width: 700px;
    margin: 0 auto;
    padding-bottom: 25px;
    .label {
      width: 180px;
      padding-right: 10px;
      text-align: right;
      color: #999;
      ~ .field {
        margin-left: 0;
      }
    }
    .field {
      width: 320px;
      height: 50px;
      position: relative;
      margin-left: 190px;
      .icon {
        position: absolute;
        left: 0;
        top: 0;
        width: 40px;
        height: 50px;
        text-align: center;
        line-height: 50px;
        color: #999;
        ~ .input {
          padding-left: 40px;
        }
      }
      .input {
        border: 1px solid #e4e4e4;
        width: 320px;
        height: 50px;
        line-height: 50px;
        padding: 0 10px;
        &.err {
          border-color: @priceColor;
        }
        &:focus,
        &:active {
          border-color: @xtxColor;
        }
      }
    }
    .error {
      width: 180px;
      padding-left: 10px;
      color: @priceColor;
    }
  }
  .submit {
    width: 320px;
    height: 50px;
    border-radius: 4px;
    background: @xtxColor;
    height: 50px;
    line-height: 50px;
    text-align: center;
    font-size: 16px;
    color: #fff;
    display: block;
    margin: 0 auto;
  }
}

```

- åœ¨ `main.ts` å¯¼å…¥å³å¯ã€‚

```diff
import { createApp } from 'vue'
import App from './App.vue'

import 'normalize.css'
+ import '@/assets/styles/common.less'

createApp(App).mount('#app')
```







##  `VsCode` é…ç½®å‚è€ƒ

### å·¥ä½œåŒºæ’ä»¶

- å·¥ä½œåŒºæ’ä»¶ï¼š`.vscode\extensions.json`

```json
{
  "recommendations": [
    "vue.volar",
    "vue.vscode-typescript-vue-plugin",
    "dbaeumer.vscode-eslint",
    "esbenp.prettier-vscode",
    "usernamehw.errorlens",
    "editorconfig.editorconfig"
  ]
}
```

### å·¥ä½œåŒºè®¾ç½®

- å·¥ä½œåŒºè®¾ç½®ï¼š `.vscode\settings.json` 
  - æŒ‡å®šæ ¼å¼åŒ–ç¨‹åº
  - `eslint` é…ç½®
  - è¡Œå°¾é…ç½®
  - ç©ºæ ¼ç¼©è¿›ä¸ªæ•°
  - ç­‰...

```json
{
  "[typescript]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[vue]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "eslint.enable": true,
  "eslint.run": "onType",
  "eslint.options": {
    "extensions": [
      ".js",
      ".ts",
      ".vue",
      ".jsx",
      ".tsx",
    ]
  },
  // æ“ä½œæ—¶ä½œä¸ºå•è¯åˆ†éš”ç¬¦çš„å­—ç¬¦
  "editor.wordSeparators": "`~!@#%^&*()=+[{]}\\|;:'\",.<>/?",
  // ä¸€ä¸ªåˆ¶è¡¨ç¬¦ç­‰äºçš„ç©ºæ ¼æ•°
  "editor.tabSize": 2,
  // ä¿å­˜æ—¶æ ¼å¼åŒ–
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll": true,
    "source.fixAll.eslint": true
  },
  // æ–‡ä»¶è¡Œå°¾ç¬¦å·
  "files.eol": "\n",
  // æ˜¯å¦ä»¥ç´§å‡‘å½¢å¼å±•ç¤ºæ–‡ä»¶å¤¹
  "explorer.compactFolders": false
}
```

### æ ¼å¼åŒ–é…ç½®

æ ¹ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶ï¼š `.prettierrc`

```json
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "printWidth": 80
}
```

æ ¹ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶ï¼š`.gitattributes`

```ts
* text eol=lf
*.txt text eol=lf
```

æ ¹ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶ï¼š`.editorconfig`

```
# editorconfig.org
root = true

[*]
charset = utf-8
indent_style = space
indent_size = 2
end_of_line = lf
insert_final_newline = true
trim_trailing_whitespace = true
quote_type = single
```



### æ‰‹åŠ¨è®¾ç½®å‚è€ƒ

- ç¦ç”¨ `VsCode` å†…ç½®çš„ `TypeScript` æ’ä»¶ï¼Œä½¿ç”¨ `Volar` æ’ä»¶æ¥ç®¡ `TS` æ£€æŸ¥å·¥ä½œã€‚

![image-20220218095648420](media/image-20220218095648420.png)
